## 传输层

**主机进程与进程之间通信的媒介层**

**功能**

复用与分用，差错检测

端口号：软件会从系统获取端口号，有两个字节组成（0\~65535），0~1024不能使用，被系统占用。

### TCP与UDP区别

![image-20220414112932251](E:\学习笔记\typora\img\image-20220414112932251.png)

### TCP

面向虚连接，面向字节流。

**可靠传输**：通过校验，序列号，重传，确认机制

重传时间：动态改变重传时间

冗余ACK（冗余确认）：接受方收到失序报文段时，会发送一个冗余ACK，指出下一个期待字节的序号。发送方收到后会立即重传。

**流量控制**：滑动窗口

发送方收到零窗口确认后，则启动一个计时器，等计时器到时间后就重新发送探测请求

**拥塞控制**：防止网络中流量数据过多，慢开始和拥塞避免，快重传，快恢复

慢启动：拥塞窗口刚开始指数增长，到了初始值16后加法增长.发生拥塞后窗口值降为0，初始值乘法减小至12（快恢复）

快重传：收到三个重复确认号立马重传

**TCP首部**

![](https://img-blog.csdnimg.cn/20200917214413232.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0luZ3N1aWZvbg==,size_16,color_FFFFFF,t_70#pic_center)

TCP首部至少20Bytes，不过可能含有可变字段，所以首部里有数据偏移量来表示首部长度

除此之外，还有序列号，确认号，紧急位URG（优先发送），PSH（从TCP缓存中直接发给上层），RST（复位），ACK，SYN，FIN，窗口大小......等字段

### UDP

1. **已经实现的可靠UDP**

  （1）RUDP 可靠数据报传输协议；

  （2）RTP 实时传输协议

  （3）UDT

应用层传下来的报文直接加上UDP首部，不分割。但网络层IP协议会分割数据，所以适合发小文件。

UDP首部只有8Bytes

![UDP首部](E:\学习笔记\typora\img\image-20220414115119107.png)

