## RDB

一定间隔时间中，检测key的变化，持久化

文件保存在dump.rdb中

存储效率高，回复速度块，适用于全量复制

牺牲性能，可能丢失数据，版本不兼容

线上不建议用save指令，避免阻塞可以用后台指令bgsave，时间由后台指定

指令：

Save -second -changes 在second秒内key变化changes次则自动保存

dumb.rdb在local/bin中时启动redis时会恢复数据

## AOF

日志记录，记录改变一次就持久化一次

**策略：**

Always

Everysec(默认)

No

**重写：**

进程内已超时的数据不在写入文件

忽略无效指令，记录最终数据的写入命令

对同一数据的操作合并为一条指令

指令： 

手动重写：bgrewriteaof

自动重写： auto-aof-rewrite-min-size size 最小尺寸

auto-aof-rewrite-percent percentage percent 增量百分比

![](E:\学习笔记\typora\img\redis.png)